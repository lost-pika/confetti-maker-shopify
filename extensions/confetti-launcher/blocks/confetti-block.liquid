<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" defer></script>

<div id="confetti-launcher-root"></div>

{% assign activeConfigsRaw = shop.metafields.confetti_maker.active_configs.value %}

<script>
  window.__CONFETTI_SETTINGS__ = {};

  try {
    const raw = {{ activeConfigsRaw | json }};
    window.__CONFETTI_SETTINGS__.configs =
      typeof raw === "string" ? JSON.parse(raw) : raw || [];
  } catch(e) {
    console.error("Confetti parse error:", e);
    window.__CONFETTI_SETTINGS__.configs = [];
  }

  console.log("CONFETTI SETTINGS:", window.__CONFETTI_SETTINGS__);
</script>

<script src="{{ 'confetti-widget.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Confetti Launcher",
  "target": "body",
  "settings": []
}
{% endschema %}
